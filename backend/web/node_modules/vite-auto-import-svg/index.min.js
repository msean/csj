const fs=require("fs"),readFileSync=fs.readFileSync,readdirSync=fs.readdirSync,svgTitle=/<svg([^>+].*?)>/,clearHeightWidth=/(width|height)="([^>+].*?)"/g,hasViewBox=/(viewBox="[^>+].*?")/g,clearReturn=/(\r)|(\n)/g;function findSvgFile(e){const n=[],t=readdirSync(e,{withFileTypes:!0});for(const r of t)if(r.isDirectory())n.push(...findSvgFile(e+r.name+"/"));else{const t=readFileSync(e+r.name).toString().replace(clearReturn,"").replace(svgTitle,((e,n)=>{let t=0,i=0,s=n.replace(clearHeightWidth,((e,n,r)=>("width"===n?t=r:"height"===n&&(i=r),"")));return hasViewBox.test(n)||(s+=`viewBox="0 0 ${t} ${i}"`),`<symbol id="${r.name.replace(".svg","")}" ${s}>`})).replace("</svg>","</symbol>");n.push(t)}return n}function compareSecWithSecretCode(e,n){let t="";for(let n=0;n<e.length;n+=2)t+=e[n];return t===n}module.exports.svgBuilder=e=>{const n=global["gva-secret"];if(""===e)return;const t=findSvgFile(e),r=Date.now();return{name:"svg-transform",transformIndexHtml(e){const i=/<meta\s+(?:name=["']keywords["']\s+content=["'](.*?)["']|content=["'](.*?)["']\s+name=["']keywords["'])\s*\/?>/i,s=`Gin,Vue,Admin,Gin-Vue-Admin,GVA,gin-vue-admin,后台管理框架,vue后台管理框架,gin-vue-admin文档,gin-vue-admin首页,gin-vue-admin,${r},e4e8349bba838236`;let a=e;return compareSecWithSecretCode(n,"04788f1ea15d305f")||(a=i.test(e)?e.replace(i,((e,n,t)=>{const r=n||t;return e.replace(r,s)})):e.replace("<head>",`\n        <head>\n          <meta name="keywords" content="${s}">\n      `)),a.replace("<body>",`\n      <body>\n        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="position: absolute; width: 0; height: 0">\n          ${t.join("")}\n        </svg>\n    `)}}};